5 ' save as "DUMPTOOL.BAS"
10 'DUMP TOOL 1989.11.21
15 'POKE &BFE03,&1A,&FD,&B,0,&20,0:CALL &FFFD8
20 CLEAR :CLS :ON ERROR GOTO "ERR1"
30 INPUT "DUMP ADDRESS=";Y$
40 AD=VAL ("&H"+Y$):C=-1
50 C=C*-1:AD$="00000":AD2$=HEX$ AD:AD$=LEFT$ (AD$,5-LEN AD2$)+AD2$
60 DA$=HEX$ TTL:IF LEN DA$=1 THEN DA$="0"+DA$
70 IF C=-1 THEN PRINT "[";RIGHT$ (DA$,2);",  ]";
80 IF C=1 THEN PRINT AD$;" =";
90 CHA$="":TTL=0:FOR T=AD TO AD+7
100 CHA=PEEK T:TTL=TTL+CHA:DA$=HEX$ CHA:IF CHA<32 THEN CHA=&H2E
110 CHA$=CHA$+CHR$ CHA
120 IF LEN DA$=1 THEN DA$="0"+DA$
130 PRINT DA$;" ";
140 I$=INKEY$
150 IF I$="S" THEN T=AD+7:NEXT :I$=STR$ (AD):GOTO 230
160 IF I$="Q" THEN T=AD+7:NEXT :GOTO 20
170 IF I$<>"" THEN BEEP 1:I$=INPUT $(1):BEEP 1
180 NEXT :PRINT "/";CHA$
190 AD=AD+8:IF AD>&HFFFFF THEN AD=0
200 DA$=HEX$ TTL:IF LEN DA$=1 THEN DA$="0"+DA$
210 IF C=-1 THEN LOCATE 4,PEEK &HBFC9C-1:PRINT RIGHT$ (DA$,2)
220 GOTO 50
230 "M":ON ERROR GOTO "ERR2"
240 PRINT :I$=Y$:INPUT "SET ADDRESS=";I$:IF I$="Q"THEN 30
250 AD=VAL ("&H"+I$)
260 AD$="00000":AD2$=HEX$ AD:AD$=LEFT$ (AD$,5-LEN AD2$)+AD2$
270 X$=HEX$ (PEEK AD)
280 IF LEN X$=1 THEN X$="0"+X$
290 PRINT AD$;"(";X$;")=";
300 INPUT X$
310 IF X$="Q"OR X$="S"THEN "M"
320 IF X$="-"THEN AD=AD-1:X$="":IF AD<0 THEN AD=&HFFFFF:GOTO260 ELSE GOTO260
330 IF VAL (X$)>255THEN 260
340 POKE AD,VAL ("&H"+X$)
350 AD=AD+1:IF AD>&HFFFFF THEN AD=0360 ELSE GOTO 260
370 "ERR1":RESUME 30
380 "ERR2":RESUME "M"
